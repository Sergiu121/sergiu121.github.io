<!DOCTYPE html>
<html  lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1"><meta name="viewport" content="width=device-width, initial-scale=1" />

      <title>3. Compilarea unui program din fișiere multiple</title>
    
      <link rel="stylesheet" href="../../_static/pygments.css">
      <link rel="stylesheet" href="../../_static/theme.css">
      <link rel="stylesheet" href="../../_static/romnn_sphinx_press_theme.css">
          <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
          <link rel="stylesheet" href="../../_static/css/theme.css " type="text/css" />
      
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>

      <!-- sphinx script_files -->
        <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../../_static/doctools.js?v=888ff710"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../../_static/my_actions.js?v=1451d81f"></script>

      
      <script src="../../_static/theme-vendors.js"></script>
      <script src="../../_static/theme.js" defer></script>
    
  <link rel="index" title="Index" href="../../genindex.html" />
  <link rel="search" title="Search" href="../../search.html" />
  <link rel="next" title="4. Legarea executabilelor folosind biblioteci externe" href="make-lib.html" />
  <link rel="prev" title="2. Compilarea unui fișier cod sursă C" href="make-intro.html" />
    <link href="../../_static/my_theme.css" rel="stylesheet" type="text/css">

  </head>

  <body>
    <div id="app" class="theme-container" :class="pageClasses"><navbar @toggle-sidebar="toggleSidebar">
  <div class="home-link-container">
      <router-link to="../../index.html" class="home-link">
      
        <span class="site-name">USO Lab Book</span>
    </router-link>
  </div>

  <div class="links">
    <navlinks class="can-hide">

  
    <div class="nav-item">
      <a href="../../index.html#uso-lab-book"
         class="nav-link ">
         Acomodarea în Linux
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../../index.html#uso-lab-book"
         class="nav-link ">
         Lucrul cu fișiere
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../../index.html#uso-lab-book"
         class="nav-link  router-link-active">
         Dezvoltarea aplicațiilor
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../../index.html#uso-lab-book"
         class="nav-link ">
         Conectarea la Internet
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../../index.html#uso-lab-book"
         class="nav-link ">
         Instalarea și utilizarea aplicațiilor
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../../index.html#uso-lab-book"
         class="nav-link ">
         Îmbunătățirea lucrului în linia de comandă
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../../index.html#uso-lab-book"
         class="nav-link ">
         Planificarea sarcinilor administrative
      </a>
    </div>
  



  
    <div class="nav-item">
      <a href="https://github.com/Sergiu121/uso-lab-book"
        class="nav-link external">
          Github <outboundlink/>
      </a>
    </div>
  

    </navlinks>
  </div>
</navbar>

      
      <div class="sidebar-mask" @click="toggleSidebar(false)">
      </div>
        <sidebar @toggle-sidebar="toggleSidebar">
          
          <navlinks>
            

  
    <div class="nav-item">
      <a href="../../index.html#uso-lab-book"
         class="nav-link ">
         Acomodarea în Linux
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../../index.html#uso-lab-book"
         class="nav-link ">
         Lucrul cu fișiere
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../../index.html#uso-lab-book"
         class="nav-link  router-link-active">
         Dezvoltarea aplicațiilor
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../../index.html#uso-lab-book"
         class="nav-link ">
         Conectarea la Internet
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../../index.html#uso-lab-book"
         class="nav-link ">
         Instalarea și utilizarea aplicațiilor
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../../index.html#uso-lab-book"
         class="nav-link ">
         Îmbunătățirea lucrului în linia de comandă
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../../index.html#uso-lab-book"
         class="nav-link ">
         Planificarea sarcinilor administrative
      </a>
    </div>
  



  
    <div class="nav-item">
      <a href="https://github.com/Sergiu121/uso-lab-book"
        class="nav-link external">
          Github <outboundlink/>
      </a>
    </div>
  

            
          </navlinks><div id="searchbox" class="searchbox" role="search">
  <div class="caption"><span class="caption-text">Search</span>
    <div class="searchformwrapper">
      <form autocomplete="off" class="search" action="../../search.html" method="get">
        <input type="text" name="q" autocomplete="off" />
        <input type="submit" value="Go" />
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
      </form>
    </div>
  </div>
</div><div class="sidebar-links" role="navigation" aria-label="main navigation">
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../../index.html#uso-lab-book">Acomodarea în Linux</a></span>
      </p>
      <ul class="">
        
          <li class="toctree-l1 "><a href="../basic/apps.html" class="reference internal ">Pornirea și oprirea aplicațiilor</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="../basic/browser.html" class="reference internal ">Folosirea eficientă a browserului web</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="../basic/terminal.html" class="reference internal ">Lucrul în terminal</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="../basic/workspace.html" class="reference internal ">Lucrul cu workspace-uri</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="../basic/cheatsheet.html" class="reference internal ">Sumar - Cheatsheet</a>

            
          </li>

        
      </ul>
    </div>
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../../index.html#uso-lab-book">Lucrul cu fișiere</a></span>
      </p>
      <ul class="">
        
          <li class="toctree-l1 "><a href="../files/paths.html" class="reference internal ">Căi în ierarhia de fișiere</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="../files/files.html" class="reference internal ">Interacțiunea cu fișiere în linia de comandă</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="../files/file_editor.html" class="reference internal ">Editor de text</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="../files/io_redirection.html" class="reference internal ">Redirectări</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="../files/archive.html" class="reference internal ">Arhive</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="../files/file_system.html" class="reference internal ">Extra - Sistemul de fișiere</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="../files/cheatsheet.html" class="reference internal ">Sumar - Cheatsheet</a>

            
          </li>

        
      </ul>
    </div>
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../../index.html#uso-lab-book">Dezvoltarea aplicațiilor</a></span>
      </p>
      <ul class="current">
        
          <li class="toctree-l1 "><a href="intro.html" class="reference internal ">Introducere</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="make-intro.html" class="reference internal ">Compilarea unui fișier cod sursă C</a>

            
          </li>

        
          <li class="toctree-l1 current"><a href="#" class="reference internal current">Compilarea unui program din fișiere multiple</a>

            
              <ul>
                
                  <li class="toctree-l2"><a href="#inspectarea-fisierelor" class="reference internal">Inspectarea fișierelor</a></li>
                
                  <li class="toctree-l2"><a href="#compilarea-programului-din-surse-multiple" class="reference internal">Compilarea programului din surse multiple</a></li>
                
                  <li class="toctree-l2"><a href="#fisiere-obiect" class="reference internal">Fișiere obiect</a></li>
                
                  <li class="toctree-l2"><a href="#exercitii" class="reference internal">Exerciții</a></li>
                
              </ul>
            
          </li>

        
          <li class="toctree-l1 "><a href="make-lib.html" class="reference internal ">Legarea executabilelor folosind biblioteci externe</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="make-simple-automation.html" class="reference internal ">Introducere în utilitarul Make și fișiere Makefile</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="make-advanced-automation.html" class="reference internal ">Aprofundarea folosirii fișierelor Makefile</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="git-intro.html" class="reference internal ">Introducere în Git și GitHub</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="git-first-commits.html" class="reference internal ">Primele commituri</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="git-branches.html" class="reference internal ">Lucrul pe branch-uri</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="git-first-pull-request.html" class="reference internal ">Crearea unui Pull Request (PR) pe GitHub</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="extra.html" class="reference internal ">Exercițîi suplimentare</a>

            
          </li>

        
      </ul>
    </div>
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../../index.html#uso-lab-book">Conectarea la Internet</a></span>
      </p>
      <ul class="">
        
          <li class="toctree-l1 "><a href="../net/browser.html" class="reference internal ">Folosirea eficientă a browserului</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="../net/connection.html" class="reference internal ">Conectarea la rețea și la Internet</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="../net/services.html" class="reference internal ">Servicii și clienți de rețea</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="../net/extra.html" class="reference internal ">Funcţionalităţi suplimentare de reţelistică</a>

            
          </li>

        
      </ul>
    </div>
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../../index.html#uso-lab-book">Instalarea și utilizarea aplicațiilor</a></span>
      </p>
      <ul class="">
        
          <li class="toctree-l1 "><a href="../app-install/start.html" class="reference internal ">Pornirea și oprirea aplicațiilor</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="../app-install/run.html" class="reference internal ">Rularea aplicațiilor</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="../app-install/config.html" class="reference internal ">Configurarea rulării aplicațiilor</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="../app-install/summary1.html" class="reference internal ">Exerciții: Pornirea, rularea și configurarea aplicațiilor</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="../app-install/show-config.html" class="reference internal ">Vizualizarea configurației sistemului</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="../app-install/install.html" class="reference internal ">Instalarea și dezinstalarea aplicațiilor</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="../app-install/install-non-standard.html" class="reference internal ">Alternative la instalarea și dezinstalarea aplicațiilor</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="../app-install/show.html" class="reference internal ">Investigarea aplicațiilor instalate</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="../app-install/summary2.html" class="reference internal ">Exerciții: Instalarea și gestiunea aplicațiilor</a>

            
          </li>

        
      </ul>
    </div>
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../../index.html#uso-lab-book">Îmbunătățirea lucrului în linia de comandă</a></span>
      </p>
      <ul class="">
        
          <li class="toctree-l1 "><a href="../improve-cli/improve-terminal.html" class="reference internal ">Îmbunătățirea lucrului în linia de comandă</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="../improve-cli/inspect-fs.html" class="reference internal ">Inspectarea sistemului de fișiere</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="../improve-cli/inspect-sys.html" class="reference internal ">Inspectarea sistemului</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="../improve-cli/inspect-files.html" class="reference internal ">Inspectarea fișierelor</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="../improve-cli/process-files.html" class="reference internal ">Prelucrarea fișierelor</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="../improve-cli/improve-shell.html" class="reference internal ">O înțelegere mai bună a shell-ului</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="../improve-cli/term-multiplexing.html" class="reference internal ">Multiplexarea terminalului</a>

            
          </li>

        
      </ul>
    </div>
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../../index.html#uso-lab-book">Planificarea sarcinilor administrative</a></span>
      </p>
      <ul class="">
        
          <li class="toctree-l1 "><a href="../task-admin/workstation.html" class="reference internal ">Folosirea unui workstation remote</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="../task-admin/remote.html" class="reference internal ">Conectarea la workstation</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="../task-admin/config.html" class="reference internal ">Configurarea stației la distanță</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="../task-admin/usage.html" class="reference internal ">Folosirea stației la distanță</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="../task-admin/storage.html" class="reference internal ">Gestionarea spațiului de stocare partajat</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="../task-admin/services-config.html" class="reference internal ">Configurarea și administrarea serviciilor</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="../task-admin/services-install.html" class="reference internal ">Instalarea aplicațiilor (serviciilor) folosind Docker</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="../task-admin/monitor.html" class="reference internal ">Monitorizarea sistemului</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="../task-admin/cron.html" class="reference internal ">Programarea rulării acțiunilor</a>

            
          </li>

        
      </ul>
    </div>
  
</div>
        </sidebar>

      <page>
          <div class="body-header" role="navigation" aria-label="navigation">
  
  <ul class="breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
    
    <li><span class="section-number">3. </span>Compilarea unui program din fișiere multiple</li>
  </ul>
  

  <ul class="page-nav">
  <li class="prev">
    <a href="make-intro.html"
       title="previous chapter">← <span class="section-number">2. </span>Compilarea unui fișier cod sursă C</a>
  </li>
  <li class="next">
    <a href="make-lib.html"
       title="next chapter"><span class="section-number">4. </span>Legarea executabilelor folosind biblioteci externe →</a>
  </li>
</ul>
  
</div>
<hr>
          <div class="content" role="main">
            
  <section id="compilarea-unui-program-din-fisiere-multiple">
<span id="app-dev-compile-multiple-files"></span><h1><span class="section-number">3. </span>Compilarea unui program din fișiere multiple<a class="headerlink" href="#compilarea-unui-program-din-fisiere-multiple" title="Link to this heading">¶</a></h1>
<p>În secțiunea anterioară, <a class="reference internal" href="make-intro.html#app-dev-compile-source-file"><span class="std std-ref">Compilarea unui fișier cod sursă C</span></a>, am creat și am compilat un sigur fișier cod sursă C, <code class="docutils literal notranslate"><span class="pre">is-prime.c</span></code>.</p>
<p>În această secțiune vom compila un program pornind de la mai multe fișiere cod sursă și fișiere header.
Mai exact, vom crea un program care afișează factorialul și inversul unui număr întreg.</p>
<section id="inspectarea-fisierelor">
<span id="app-dev-inspect-files"></span><h2><span class="section-number">3.1. </span>Inspectarea fișierelor<a class="headerlink" href="#inspectarea-fisierelor" title="Link to this heading">¶</a></h2>
<p>Afișăm conținutul directorului <code class="docutils literal notranslate"><span class="pre">support/compile-multiple</span></code>, folosind comanda <code class="docutils literal notranslate"><span class="pre">ls</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>student@uso:~$<span class="w"> </span>ls<span class="w"> </span>support/compile-multiple
algorithms.c<span class="w">  </span>algorithms.h<span class="w">  </span>main.c
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">main.c</span></code> este fișier cod sursă și conține funcția <code class="docutils literal notranslate"><span class="pre">main</span></code> din care pornim logica programului.</p>
<p><code class="docutils literal notranslate"><span class="pre">algorithms.h</span></code> este fișier <em>header</em> (cu extensia <code class="docutils literal notranslate"><span class="pre">.h</span></code>), conține <strong>declarația</strong> (<em>antetul</em>) funcției <code class="docutils literal notranslate"><span class="pre">factorial</span></code>:  <code class="docutils literal notranslate"><span class="pre">unsigned</span> <span class="pre">factorial(int</span> <span class="pre">n);</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">algorithms.c</span></code> este fișier cod sursă și conține <strong>definiția</strong> (<em>implementarea</em>) funcției <code class="docutils literal notranslate"><span class="pre">factorial</span></code>.</p>
<p><strong>Exercițiu:</strong> Verificați conținutul fișierelor <code class="docutils literal notranslate"><span class="pre">main.c</span></code>, <code class="docutils literal notranslate"><span class="pre">algorithms.c</span></code> și <code class="docutils literal notranslate"><span class="pre">algorithms.h</span></code> folosind comanda <code class="docutils literal notranslate"><span class="pre">cat</span></code>, pagerul <code class="docutils literal notranslate"><span class="pre">less</span></code> sau editorul <code class="docutils literal notranslate"><span class="pre">nano</span></code>.</p>
</section>
<section id="compilarea-programului-din-surse-multiple">
<span id="app-dev-compile-multiple-sources"></span><h2><span class="section-number">3.2. </span>Compilarea programului din surse multiple<a class="headerlink" href="#compilarea-programului-din-surse-multiple" title="Link to this heading">¶</a></h2>
<p>Ne plasăm în directorul <code class="docutils literal notranslate"><span class="pre">support/compile-multiple</span></code> folosind comanda <code class="docutils literal notranslate"><span class="pre">cd</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>student@uso:~$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>support/compile-multiple
student@uso:~/support/compile-multiple$<span class="w"> </span>ls
algorithms.c<span class="w">  </span>algorithms.h<span class="w">  </span>main.c
</pre></div>
</div>
<p>Compilăm fișierele <code class="docutils literal notranslate"><span class="pre">algorithms.c</span></code> și <code class="docutils literal notranslate"><span class="pre">main.c</span></code> într-un singur program numit <code class="docutils literal notranslate"><span class="pre">algorithms</span></code> folosind comanda <code class="docutils literal notranslate"><span class="pre">gcc</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>student@uso:~/support/compile-multiple$<span class="w"> </span>gcc<span class="w"> </span>-o<span class="w"> </span>algorithms<span class="w"> </span>main.c<span class="w"> </span>algorithms.c
student@uso:~/support/compile-multiple$<span class="w"> </span>ls
algorithms<span class="w">  </span>algorithms.c<span class="w">  </span>algorithms.h<span class="w">  </span>main.c
</pre></div>
</div>
<p>Acum GCC a compilat ambele fișiere cod sursă (<code class="docutils literal notranslate"><span class="pre">main.c</span></code> și <code class="docutils literal notranslate"><span class="pre">algorithms.c</span></code>), le-a legat, și a creat fișierul executabil <code class="docutils literal notranslate"><span class="pre">algorithms</span></code>.
Rulăm programul <code class="docutils literal notranslate"><span class="pre">algorithms</span></code> ca mai jos:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>student@uso:~/support/compile-multiple$<span class="w"> </span>./algorithms
gimme<span class="w"> </span>number<span class="w"> </span>and<span class="w"> </span>i<span class="err">&#39;</span>ll<span class="w"> </span>give<span class="w"> </span>you<span class="w"> </span>factorial:<span class="w"> </span><span class="m">12</span>
<span class="m">12</span>!<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">479001600</span>
</pre></div>
</div>
<p>Acum, de fiecare dată când modificăm fișierul <code class="docutils literal notranslate"><span class="pre">main.c</span></code>, compilatorul va trece iar prin etapa de compilare pentru ambele fișiere cod sursă, chiar dacă <code class="docutils literal notranslate"><span class="pre">algorithms.c</span></code> nu a fost și el modificat; la fel și vice-versa.
Acest lucru este ineficient atunci când lucrăm la un proiect mai mare, unde etapa de compilare durează mult <a class="footnote-reference brackets" href="#compile-linux-kernel" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>.
În secțiunea următoare, <a class="reference internal" href="#app-dev-object-files"><span class="std std-ref">Fișiere obiect</span></a>, vedem cum scăpăm de această problemă.</p>
<p>Ștergem fișierul <code class="docutils literal notranslate"><span class="pre">algorithms</span></code> ca să avem directorul curat, folosind comanda <code class="docutils literal notranslate"><span class="pre">rm</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>student@uso:~/support/compile-multiple$<span class="w"> </span>rm<span class="w"> </span>algorithms
student@uso:~/support/compile-multiple$<span class="w"> </span>ls
algorithms.c<span class="w">  </span>algorithms.h<span class="w">  </span>main.c
</pre></div>
</div>
<p>Vom reface executabilul <code class="docutils literal notranslate"><span class="pre">algorithms</span></code> în secțiunea <a class="reference internal" href="#app-dev-object-files"><span class="std std-ref">Fișiere obiect</span></a>.</p>
</section>
<section id="fisiere-obiect">
<span id="app-dev-object-files"></span><h2><span class="section-number">3.3. </span>Fișiere obiect<a class="headerlink" href="#fisiere-obiect" title="Link to this heading">¶</a></h2>
<p>Ca să evităm recompilarea fișierelor cod sursă care nu au fost modifcate, putem să <em>descompunem</em> etapa de compilare în 2 părți:</p>
<ol class="arabic simple">
<li><p>Compilarea tuturor fișierelor cod sursă (<em>fișiere cu extensia .c</em>) până la <strong>fișiere obiect</strong> (<em>fișiere cu extensia .o</em>)</p></li>
<li><p>Legarea fișierelor obiect într-un <em>executabil</em>.</p></li>
</ol>
<p>Diagrama de mai jos descrie aceste două etape:</p>
<img alt="../../_images/ditaa-b8e7da93170fbaf8f674445e277878840e572c05.png" src="../../_images/ditaa-b8e7da93170fbaf8f674445e277878840e572c05.png" />
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Pașii 1 reprezintă pașii de compilare, iar pasul 2 este pas de legare.</p>
</div>
<p>Astfel, executabilul final depinde doar de fișierele obiect.
Fiecare fișier obiect depinde de fișierul cod sursă asociat (<code class="docutils literal notranslate"><span class="pre">main.o</span></code> de <code class="docutils literal notranslate"><span class="pre">main.c</span></code> și <code class="docutils literal notranslate"><span class="pre">algorithms.o</span></code> de <code class="docutils literal notranslate"><span class="pre">algorithms.c</span></code>).
Atunci când vom modifica fișierul <code class="docutils literal notranslate"><span class="pre">main.c</span></code>, vom regenera doar fișierul obiect <code class="docutils literal notranslate"><span class="pre">main.o</span></code>.
Nu este nevoie să regenerăm fișierul <code class="docutils literal notranslate"><span class="pre">algorithms.o</span></code> pentru că <code class="docutils literal notranslate"><span class="pre">algorithms.c</span></code> nu a fost modificat.</p>
<p>În subsecțiunile următoare vom compila fișierele sursă, <code class="docutils literal notranslate"><span class="pre">main.c</span></code> și <code class="docutils literal notranslate"><span class="pre">algorithms.c</span></code>, în fișiere obiect și le vom lega astfel încât, în final, vom obține executabilul <code class="docutils literal notranslate"><span class="pre">algorithms</span></code>.</p>
<section id="compilarea-fisierelor-cod-sursa-in-fisiere-obiect">
<span id="app-dev-compile-to-object-files"></span><h3><span class="section-number">3.3.1. </span>Compilarea fișierelor cod sursă în fișiere obiect<a class="headerlink" href="#compilarea-fisierelor-cod-sursa-in-fisiere-obiect" title="Link to this heading">¶</a></h3>
<p>În această subsecțiune vom trece prin pasul <code class="docutils literal notranslate"><span class="pre">1</span></code> din diagrama din secțiunea <a class="reference internal" href="#app-dev-object-files"><span class="std std-ref">Fișiere obiect</span></a>, adică pașii de <em>compilare</em>.</p>
<p>Compilăm fișierul <code class="docutils literal notranslate"><span class="pre">main.c</span></code> într-un fișier obiect <code class="docutils literal notranslate"><span class="pre">main.o</span></code> folosind opțiunea <code class="docutils literal notranslate"><span class="pre">-c</span></code> a comenzii <code class="docutils literal notranslate"><span class="pre">gcc</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>student@uso:~/support/compile-multiple$<span class="w"> </span>gcc<span class="w"> </span>-c<span class="w"> </span>main.c
student@uso:~/support/compile-multiple$<span class="w"> </span>ls
algorithms.c<span class="w">  </span>algorithms.h<span class="w">  </span>main.c<span class="w">  </span>main.o
</pre></div>
</div>
<p>Opțiunea <code class="docutils literal notranslate"><span class="pre">-c</span></code> compilează fișierul cod sursă <code class="docutils literal notranslate"><span class="pre">main.c</span></code> într-un fișier obiect <code class="docutils literal notranslate"><span class="pre">main.o</span></code>.</p>
<p>Facem același lucru pentru <code class="docutils literal notranslate"><span class="pre">algorithms.c</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>student@uso:~/support/compile-multiple$<span class="w"> </span>gcc<span class="w"> </span>-c<span class="w"> </span>algorithms.c
student@uso:~/support/compile-multiple$<span class="w"> </span>ls
algorithms.c<span class="w">  </span>algorithms.h<span class="w">  </span>algorithms.o<span class="w">  </span>main.c<span class="w">  </span>main.o
</pre></div>
</div>
<p>Acum avem 2 fișiere obiect, <code class="docutils literal notranslate"><span class="pre">main.o</span></code> și <code class="docutils literal notranslate"><span class="pre">algorithms.o</span></code>, pe care urmează să le legăm și să formăm executabilul <code class="docutils literal notranslate"><span class="pre">algorithms</span></code>.</p>
</section>
<section id="legarea-fisierelor-obiect-intr-un-fisier-executabil">
<span id="app-dev-link-object-files"></span><h3><span class="section-number">3.3.2. </span>Legarea fișierelor obiect într-un fișier executabil<a class="headerlink" href="#legarea-fisierelor-obiect-intr-un-fisier-executabil" title="Link to this heading">¶</a></h3>
<p>În această subsecțiune vom trece prin pasul <code class="docutils literal notranslate"><span class="pre">2</span></code> din diagrama din secțiunea <a class="reference internal" href="#app-dev-object-files"><span class="std std-ref">Fișiere obiect</span></a>, adică pasul de <em>legare</em>.</p>
<p>Acum că avem 2 fișiere obiect, trebuie să le legăm pentru a obține executabilul final.
Legăm fișierele obiect <code class="docutils literal notranslate"><span class="pre">main.o</span></code> și <code class="docutils literal notranslate"><span class="pre">algorithms.o</span></code> folosind comanda <code class="docutils literal notranslate"><span class="pre">gcc</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>student@uso:~/support/compile-multiple$<span class="w"> </span>gcc<span class="w"> </span>-o<span class="w"> </span>algorithms<span class="w"> </span>main.o<span class="w"> </span>algorithms.o
student@uso:~/support/compile-multiple$<span class="w"> </span>ls
algorithms<span class="w">  </span>algorithms.c<span class="w">  </span>algorithms.h<span class="w">  </span>algorithms.o<span class="w">  </span>main.c<span class="w">  </span>main.o
</pre></div>
</div>
<p>Am creat executabilul final <code class="docutils literal notranslate"><span class="pre">algorithms</span></code> din 2 fișiere obiect.
Rulăm executabilul și vedem că are același comportament ca în secțiunea <a class="reference internal" href="#app-dev-compile-multiple-sources"><span class="std std-ref">Compilarea programului din surse multiple</span></a>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>student@uso:~/support/compile-multiple$<span class="w"> </span>./algorithms
gimme<span class="w"> </span>number<span class="w"> </span>and<span class="w"> </span>i<span class="err">&#39;</span>ll<span class="w"> </span>give<span class="w"> </span>you<span class="w"> </span>factorial:<span class="w"> </span><span class="m">12</span>
<span class="m">12</span>!<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">479001600</span>
</pre></div>
</div>
<p>Ștergem fișierul <code class="docutils literal notranslate"><span class="pre">algorithms</span></code> folosind comanda <code class="docutils literal notranslate"><span class="pre">rm</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>student@uso:~/support/compile-multiple$<span class="w"> </span>rm<span class="w"> </span>algorithms
student@uso:~/support/compile-multiple$<span class="w"> </span>ls
algorithms.c<span class="w">  </span>algorithms.h<span class="w">  </span>algorithms.o<span class="w">    </span>main.c<span class="w">  </span>main.o
</pre></div>
</div>
<p>Plecând de la 2 fișiere obiect, <code class="docutils literal notranslate"><span class="pre">main.o</span></code> și <code class="docutils literal notranslate"><span class="pre">algorithms.o</span></code>, am obținut același executabil <code class="docutils literal notranslate"><span class="pre">algorithms</span></code>.</p>
<p>Știind cum compilăm individual 2 fișiere cod sursă, vedem în secțiunea următoare, <a class="reference internal" href="#app-dev-modify-recompile"><span class="std std-ref">Modificarea fișierelor sursă și recompilarea lor</span></a>, beneficiile compilării incrementale.
Recompilăm <em>doar</em> fișierele care au fost modificate de la ultima compilare și refacem executabilul prin legarea fișierelor obiect vechi (nemodificate de la ultima compilare) cu cele noi (recompilate după modificarea fișierelor cod sursă).</p>
</section>
<section id="modificarea-fisierelor-sursa-si-recompilarea-lor">
<span id="app-dev-modify-recompile"></span><h3><span class="section-number">3.3.3. </span>Modificarea fișierelor sursă și recompilarea lor<a class="headerlink" href="#modificarea-fisierelor-sursa-si-recompilarea-lor" title="Link to this heading">¶</a></h3>
<p>În continuare, vedem care sunt avantajele compilării incrementale, în care unele operații de compilare nu au loc.</p>
<p>Modificăm fișierul <code class="docutils literal notranslate"><span class="pre">main.c</span></code>, îl recompilăm într-un fișier obiect <code class="docutils literal notranslate"><span class="pre">main.o</span></code>.
Fișierul <code class="docutils literal notranslate"><span class="pre">algorithms.o</span></code> rămâne nemodificat.
Legăm noul fișier <code class="docutils literal notranslate"><span class="pre">main.o</span></code> cu vechiul fișier <code class="docutils literal notranslate"><span class="pre">algorithms.o</span></code> pentru a obține un nou executabil <code class="docutils literal notranslate"><span class="pre">algorithms</span></code>.</p>
<p>Adăugăm linia <code class="docutils literal notranslate"><span class="pre">printf(&quot;%d!</span> <span class="pre">=</span> <span class="pre">%u\n&quot;,</span> <span class="pre">n</span> <span class="pre">+</span> <span class="pre">1,</span> <span class="pre">factorial(n</span> <span class="pre">+</span> <span class="pre">1));</span></code> în fișierul <code class="docutils literal notranslate"><span class="pre">main.c</span></code>, ca în imaginea de mai jos:</p>
<figure class="align-default">
<img alt="Modificarea fișierului ``main.c``" src="../../_images/modify-main.gif" />
</figure>
<p>Compilăm fișierul <code class="docutils literal notranslate"><span class="pre">main.c</span></code> într-un fișier obiect <code class="docutils literal notranslate"><span class="pre">main.o</span></code> folosind <code class="docutils literal notranslate"><span class="pre">gcc</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>student@uso:~/support/compile-multiple$<span class="w"> </span>gcc<span class="w"> </span>-c<span class="w"> </span>main.c
student@uso:~/support/compile-multiple$<span class="w"> </span>ls
algorithms.c<span class="w">  </span>algorithms.h<span class="w">  </span>algorithms.o<span class="w">    </span>main.c<span class="w">  </span>main.o
</pre></div>
</div>
<p>Legăm fișierele obiect <code class="docutils literal notranslate"><span class="pre">main.o</span></code> și <code class="docutils literal notranslate"><span class="pre">algorithms.o</span></code> folosind comanda <code class="docutils literal notranslate"><span class="pre">gcc</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>student@uso:~/support/compile-multiple$<span class="w"> </span>gcc<span class="w"> </span>-o<span class="w"> </span>algorithms<span class="w"> </span>main.o<span class="w"> </span>algorithms.o
student@uso:~/support/compile-multiple$<span class="w"> </span>ls
algorithms<span class="w">  </span>algorithms.c<span class="w">  </span>algorithms.h<span class="w">  </span>algorithms.o<span class="w">  </span>main.c<span class="w">  </span>main.o
</pre></div>
</div>
<p>Am creat executabilul final <code class="docutils literal notranslate"><span class="pre">algorithms</span></code> din 2 fișiere obiect, fără să recompilăm fișierul <code class="docutils literal notranslate"><span class="pre">algorithms.c</span></code> (care nu a fost modificat).</p>
<p>Rulăm executabilul <code class="docutils literal notranslate"><span class="pre">algorithms</span></code>, ca mai jos:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>student@uso:~/support/compile-multiple$<span class="w"> </span>./algorithms
gimme<span class="w"> </span>number<span class="w"> </span>and<span class="w"> </span>i<span class="err">&#39;</span>ll<span class="w"> </span>give<span class="w"> </span>you<span class="w"> </span>factorial:<span class="w"> </span><span class="m">10</span>
<span class="m">10</span>!<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3628800</span>
<span class="m">11</span>!<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">39916800</span>
</pre></div>
</div>
<p>Am văzut în această secțiune cum compilăm eficient un program din mai multe fișiere cod sursă.
Concret, am compilat fișierele <code class="docutils literal notranslate"><span class="pre">main.c</span></code> și <code class="docutils literal notranslate"><span class="pre">algorithms.c</span></code>, independent unul față de celălalt, în fișierele obiect <code class="docutils literal notranslate"><span class="pre">main.o</span></code> și <code class="docutils literal notranslate"><span class="pre">algorithms.o</span></code>, le-am legat, și am creat executabilul <code class="docutils literal notranslate"><span class="pre">algorithms</span></code>.</p>
</section>
</section>
<section id="exercitii">
<span id="app-dev-make-multiple-ex"></span><h2><span class="section-number">3.4. </span>Exerciții<a class="headerlink" href="#exercitii" title="Link to this heading">¶</a></h2>
<ol class="arabic simple">
<li><p>Mergeți în directorul <code class="docutils literal notranslate"><span class="pre">~/support/compile-multiple-ex</span></code>.</p></li>
<li><p>Inspectați fișierele <code class="docutils literal notranslate"><span class="pre">main.c</span></code> și <code class="docutils literal notranslate"><span class="pre">lottery.c</span></code>.</p></li>
<li><p>Compilați fișierul cod sursă <code class="docutils literal notranslate"><span class="pre">main.c</span></code> în fișierul obiect <code class="docutils literal notranslate"><span class="pre">main.o</span></code>.</p></li>
<li><p>Compilați fișierul cod sursă <code class="docutils literal notranslate"><span class="pre">lottery.c</span></code> în fișierul obiect <code class="docutils literal notranslate"><span class="pre">lottery.o</span></code>.</p></li>
<li><p>Legați fișierele obiect <code class="docutils literal notranslate"><span class="pre">main.o</span></code> și <code class="docutils literal notranslate"><span class="pre">lottery.o</span></code> în executabilul <code class="docutils literal notranslate"><span class="pre">lottery</span></code>.</p></li>
<li><p>Verificați că funcționează executabilul <code class="docutils literal notranslate"><span class="pre">lottery</span></code>.</p></li>
</ol>
<p class="rubric">Note de subsol</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="compile-linux-kernel" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>Compilarea <a class="reference external" href="https://github.com/torvalds/linux">nucleului Linux</a> durează, în general, mult.
<a class="reference external" href="https://ubuntuforums.org/showthread.php?t=650461">https://ubuntuforums.org/showthread.php?t=650461</a></p>
</aside>
</aside>
</section>
</section>


          </div>
          <div class="page-nav">
            <div class="inner"><ul class="page-nav">
  <li class="prev">
    <a href="make-intro.html"
       title="previous chapter">← <span class="section-number">2. </span>Compilarea unui fișier cod sursă C</a>
  </li>
  <li class="next">
    <a href="make-lib.html"
       title="next chapter"><span class="section-number">4. </span>Legarea executabilelor folosind biblioteci externe →</a>
  </li>
</ul><div class="footer" role="contentinfo">
      &#169; Copyright 2020, USO Team.
    <br>
    Created using <a href="http://sphinx-doc.org/">Sphinx</a> 7.2.5 with <a href="https://github.com/romnn/sphinx_press_theme">Press Theme</a>.
</div>
            </div>
          </div>
      </page>
    </div>
    
    
  </body>
</html>